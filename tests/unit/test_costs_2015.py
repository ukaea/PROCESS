"""Unit tests for costs_2015.f90."""

from typing import Any, NamedTuple

import numpy as np
import pytest

from process.costs_2015 import Costs2015
from process.data_structure import (
    build_variables,
    cost_2015_variables,
    cost_variables,
    current_drive_variables,
    fwbs_variables,
    heat_transport_variables,
    pf_power_variables,
    pfcoil_variables,
    physics_variables,
    tfcoil_variables,
)


@pytest.fixture
def costs2015():
    """Provides Costs2015 object for testing.

    :return costs2015: initialised costs2015 object
    :type costs2015: process.costs2015.Costs2015
    """
    return Costs2015()


class CalcBuildingCostsParam(NamedTuple):
    pwpnb: Any = None

    r_pf_coil_outer_max: Any = None

    p_plant_primary_heat_mw: Any = None

    p_plant_secondary_heat_mw: Any = None

    helpow: Any = None

    c_tf_total: Any = None

    n_tf_coils: Any = None

    e_tf_magnetic_stored_total_gj: Any = None

    r_cryostat_inboard: Any = None

    z_cryostat_half_inside: Any = None

    cost_factor_buildings: Any = None

    light_build_cost_per_vol: Any = None

    tok_build_cost_per_vol: Any = None

    s_kref: Any = None

    s_k: Any = None

    s_cref: Any = None

    s_cost: Any = None

    s_cost_factor: Any = None

    expected_s_kref: Any = None

    expected_s_k: Any = None

    expected_s_cref: Any = None

    expected_s_cost: Any = None

    expected_s_cost_factor: Any = None


@pytest.mark.parametrize(
    "calcbuildingcostsparam",
    (
        CalcBuildingCostsParam(
            pwpnb=109.38112972595434,
            r_pf_coil_outer_max=17.814040399601147,
            p_plant_primary_heat_mw=2112.8165753998965,
            p_plant_secondary_heat_mw=311.54038043019023,
            helpow=142703.41458500578,
            c_tf_total=234156150,
            n_tf_coils=18,
            e_tf_magnetic_stored_total_gj=130.10721529398921,
            r_cryostat_inboard=18.314040399601147,
            z_cryostat_half_inside=15.118436894660423,
            cost_factor_buildings=1,
            light_build_cost_per_vol=270,
            tok_build_cost_per_vol=1283,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                    dtype=np.float64,
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                    dtype=np.float64,
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                    dtype=np.float64,
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                    dtype=np.float64,
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                    dtype=np.float64,
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
        CalcBuildingCostsParam(
            pwpnb=109.38112972595434,
            r_pf_coil_outer_max=17.81462428923539,
            p_plant_primary_heat_mw=2111.8102173541502,
            p_plant_secondary_heat_mw=640.27066522894324,
            helpow=823308.59959198488,
            c_tf_total=234156150,
            n_tf_coils=18,
            e_tf_magnetic_stored_total_gj=129.99240835373195,
            r_cryostat_inboard=18.31462428923539,
            z_cryostat_half_inside=15.165858901796364,
            cost_factor_buildings=1,
            light_build_cost_per_vol=270,
            tok_build_cost_per_vol=1283,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        893.59786239725906,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        626974274.45348454,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31962.659424309255,
                        109.38112972595434,
                        823.30859959198483,
                        317.36083856661548,
                        13.008675,
                        129.99240835373195,
                        2752.0808825830936,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        893.59786239725906,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2410693739.0726619,
                        6891011.1727351239,
                        473739866.32260108,
                        105883266.24913743,
                        42456884.340659343,
                        29961664.852262605,
                        43063811.083146818,
                        3147520243.093204,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        626974274.45348454,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
    ),
)
def test_calc_building_costs(calcbuildingcostsparam, monkeypatch, costs2015):
    """
    Automatically generated Regression Unit Test for calc_building_costs.

    This test was generated using data from tests/regression/scenarios/costs_paper/IN.DAT.

    :param calcbuildingcostsparam: the data used to mock and assert in this test.
    :type calcbuildingcostsparam: calcbuildingcostsparam

    :param monkeypatch: pytest fixture used to mock module/class variables
    :type monkeypatch: _pytest.monkeypatch.monkeypatch
    """

    monkeypatch.setattr(current_drive_variables, "pwpnb", calcbuildingcostsparam.pwpnb)

    monkeypatch.setattr(
        pfcoil_variables,
        "r_pf_coil_outer_max",
        calcbuildingcostsparam.r_pf_coil_outer_max,
    )

    monkeypatch.setattr(
        heat_transport_variables,
        "p_plant_primary_heat_mw",
        calcbuildingcostsparam.p_plant_primary_heat_mw,
    )

    monkeypatch.setattr(
        heat_transport_variables,
        "p_plant_secondary_heat_mw",
        calcbuildingcostsparam.p_plant_secondary_heat_mw,
    )

    monkeypatch.setattr(
        heat_transport_variables, "helpow", calcbuildingcostsparam.helpow
    )

    monkeypatch.setattr(
        tfcoil_variables, "c_tf_total", calcbuildingcostsparam.c_tf_total
    )

    monkeypatch.setattr(
        tfcoil_variables, "n_tf_coils", calcbuildingcostsparam.n_tf_coils
    )

    monkeypatch.setattr(
        tfcoil_variables,
        "e_tf_magnetic_stored_total_gj",
        calcbuildingcostsparam.e_tf_magnetic_stored_total_gj,
    )

    monkeypatch.setattr(
        fwbs_variables, "r_cryostat_inboard", calcbuildingcostsparam.r_cryostat_inboard
    )

    monkeypatch.setattr(
        fwbs_variables,
        "z_cryostat_half_inside",
        calcbuildingcostsparam.z_cryostat_half_inside,
    )

    monkeypatch.setattr(
        cost_variables,
        "cost_factor_buildings",
        calcbuildingcostsparam.cost_factor_buildings,
    )

    monkeypatch.setattr(
        cost_variables,
        "light_build_cost_per_vol",
        calcbuildingcostsparam.light_build_cost_per_vol,
    )

    monkeypatch.setattr(
        cost_variables,
        "tok_build_cost_per_vol",
        calcbuildingcostsparam.tok_build_cost_per_vol,
    )

    monkeypatch.setattr(cost_2015_variables, "s_kref", calcbuildingcostsparam.s_kref)

    monkeypatch.setattr(cost_2015_variables, "s_k", calcbuildingcostsparam.s_k)

    monkeypatch.setattr(cost_2015_variables, "s_cref", calcbuildingcostsparam.s_cref)

    monkeypatch.setattr(cost_2015_variables, "s_cost", calcbuildingcostsparam.s_cost)

    monkeypatch.setattr(
        cost_2015_variables, "s_cost_factor", calcbuildingcostsparam.s_cost_factor
    )

    costs2015.calc_building_costs()

    assert cost_2015_variables.s_kref == pytest.approx(
        calcbuildingcostsparam.expected_s_kref
    )

    assert cost_2015_variables.s_k == pytest.approx(calcbuildingcostsparam.expected_s_k)

    assert cost_2015_variables.s_cref == pytest.approx(
        calcbuildingcostsparam.expected_s_cref
    )

    assert cost_2015_variables.s_cost == pytest.approx(
        calcbuildingcostsparam.expected_s_cost
    )

    assert cost_2015_variables.s_cost_factor == pytest.approx(
        calcbuildingcostsparam.expected_s_cost_factor
    )


class CalcLandCostsParam(NamedTuple):
    dr_tf_inner_bore: Any = None

    dh_tf_inner_bore: Any = None

    dr_tf_inboard: Any = None

    r_cryostat_inboard: Any = None

    cost_factor_land: Any = None

    costexp: Any = None

    s_kref: Any = None

    s_k: Any = None

    s_cref: Any = None

    s_cost: Any = None

    s_cost_factor: Any = None

    expected_s_kref: Any = None

    expected_s_k: Any = None

    expected_s_cref: Any = None

    expected_s_cost: Any = None

    expected_s_cost_factor: Any = None


@pytest.mark.parametrize(
    "calclandcostsparam",
    (
        CalcLandCostsParam(
            dr_tf_inner_bore=11.753025251709767,
            dh_tf_inner_bore=14.474776497695849,
            dr_tf_inboard=0.91858999999999991,
            r_cryostat_inboard=18.314040399601147,
            cost_factor_land=1,
            costexp=0.80000000000000004,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
        CalcLandCostsParam(
            dr_tf_inner_bore=11.753830505540675,
            dh_tf_inner_bore=14.450776497695848,
            dr_tf_inboard=0.91858999999999991,
            r_cryostat_inboard=18.31462428923539,
            cost_factor_land=1,
            costexp=0.80000000000000004,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        31962.659424309255,
                        109.38112972595434,
                        823.30859959198483,
                        317.36083856661548,
                        13.008675,
                        129.99240835373195,
                        2752.0808825830936,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        893.59786239725906,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2410693739.0726619,
                        6891011.1727351239,
                        473739866.32260108,
                        105883266.24913743,
                        42456884.340659343,
                        29961664.852262605,
                        43063811.083146818,
                        3147520243.093204,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        626974274.45348454,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31962.659424309255,
                        109.38112972595434,
                        823.30859959198483,
                        317.36083856661548,
                        13.008675,
                        129.99240835373195,
                        2752.0808825830936,
                        0,
                        1053.7701699348972,
                        1053.7701699348972,
                        16.287956497695848,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        893.59786239725906,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2410693739.0726619,
                        6891011.1727351239,
                        473739866.32260108,
                        105883266.24913743,
                        42456884.340659343,
                        29961664.852262605,
                        43063811.083146818,
                        3147520243.093204,
                        63837385.248702273,
                        319708329.08223164,
                        169309805.61532342,
                        552855519.94625735,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        626974274.45348454,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
    ),
)
def test_calc_land_costs(calclandcostsparam, monkeypatch, costs2015):
    """
    Automatically generated Regression Unit Test for calc_land_costs.

    This test was generated using data from tests/regression/scenarios/costs_paper/IN.DAT.

    :param calclandcostsparam: the data used to mock and assert in this test.
    :type calclandcostsparam: calclandcostsparam

    :param monkeypatch: pytest fixture used to mock module/class variables
    :type monkeypatch: _pytest.monkeypatch.monkeypatch
    """

    monkeypatch.setattr(
        build_variables, "dr_tf_inner_bore", calclandcostsparam.dr_tf_inner_bore
    )

    monkeypatch.setattr(
        build_variables, "dh_tf_inner_bore", calclandcostsparam.dh_tf_inner_bore
    )

    monkeypatch.setattr(
        build_variables, "dr_tf_inboard", calclandcostsparam.dr_tf_inboard
    )

    monkeypatch.setattr(
        fwbs_variables, "r_cryostat_inboard", calclandcostsparam.r_cryostat_inboard
    )

    monkeypatch.setattr(
        cost_variables, "cost_factor_land", calclandcostsparam.cost_factor_land
    )

    monkeypatch.setattr(cost_variables, "costexp", calclandcostsparam.costexp)

    monkeypatch.setattr(cost_2015_variables, "s_kref", calclandcostsparam.s_kref)

    monkeypatch.setattr(cost_2015_variables, "s_k", calclandcostsparam.s_k)

    monkeypatch.setattr(cost_2015_variables, "s_cref", calclandcostsparam.s_cref)

    monkeypatch.setattr(cost_2015_variables, "s_cost", calclandcostsparam.s_cost)

    monkeypatch.setattr(
        cost_2015_variables, "s_cost_factor", calclandcostsparam.s_cost_factor
    )

    costs2015.calc_land_costs()

    assert cost_2015_variables.s_kref == pytest.approx(
        calclandcostsparam.expected_s_kref
    )

    assert cost_2015_variables.s_k == pytest.approx(calclandcostsparam.expected_s_k)

    assert cost_2015_variables.s_cref == pytest.approx(
        calclandcostsparam.expected_s_cref
    )

    assert cost_2015_variables.s_cost == pytest.approx(
        calclandcostsparam.expected_s_cost
    )

    assert cost_2015_variables.s_cost_factor == pytest.approx(
        calclandcostsparam.expected_s_cost_factor
    )


class CalcTfCoilCostsParam(NamedTuple):
    n_tf_coils: Any = None

    len_tf_coil: Any = None

    n_tf_coil_turns: Any = None

    m_tf_coil_copper: Any = None

    m_tf_coil_superconductor: Any = None

    cost_factor_tf_coils: Any = None

    costexp: Any = None

    s_kref: Any = None

    s_k: Any = None

    s_cref: Any = None

    s_cost: Any = None

    s_cost_factor: Any = None

    expected_s_kref: Any = None

    expected_s_k: Any = None

    expected_s_cref: Any = None

    expected_s_cost: Any = None

    expected_s_cost_factor: Any = None


@pytest.mark.parametrize(
    "calctfcoilcostsparam",
    (
        CalcTfCoilCostsParam(
            n_tf_coils=18,
            len_tf_coil=46.64605032553105,
            n_tf_coil_turns=200.13346153846152,
            m_tf_coil_copper=31746.02769109578,
            m_tf_coil_superconductor=10284.64237165747,
            cost_factor_tf_coils=1,
            costexp=0.80000000000000004,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
        CalcTfCoilCostsParam(
            n_tf_coils=18,
            len_tf_coil=46.6270502920285,
            n_tf_coil_turns=200.13346153846155,
            m_tf_coil_copper=24895.07929687943,
            m_tf_coil_superconductor=7945.1211509981658,
            cost_factor_tf_coils=1,
            costexp=0.80000000000000004,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        31962.659424309255,
                        109.38112972595434,
                        823.30859959198483,
                        317.36083856661548,
                        13.008675,
                        129.99240835373195,
                        2752.0808825830936,
                        0,
                        1053.7701699348972,
                        1053.7701699348972,
                        16.287956497695848,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        893.59786239725906,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2410693739.0726619,
                        6891011.1727351239,
                        473739866.32260108,
                        105883266.24913743,
                        42456884.340659343,
                        29961664.852262605,
                        43063811.083146818,
                        3147520243.093204,
                        63837385.248702273,
                        319708329.08223164,
                        169309805.61532342,
                        552855519.94625735,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        626974274.45348454,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31962.659424309255,
                        109.38112972595434,
                        823.30859959198483,
                        317.36083856661548,
                        13.008675,
                        129.99240835373195,
                        2752.0808825830936,
                        0,
                        1053.7701699348972,
                        1053.7701699348972,
                        16.287956497695848,
                        0,
                        839.28690525651302,
                        0,
                        167969.39357288877,
                        448111.42734382977,
                        143012.18071796698,
                        0,
                        167969.39357288877,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        893.59786239725906,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2410693739.0726619,
                        6891011.1727351239,
                        473739866.32260108,
                        105883266.24913743,
                        42456884.340659343,
                        29961664.852262605,
                        43063811.083146818,
                        3147520243.093204,
                        63837385.248702273,
                        319708329.08223164,
                        169309805.61532342,
                        552855519.94625735,
                        331380200.55787051,
                        0,
                        732959475.07431877,
                        34152008.422703326,
                        386819831.65432388,
                        4000000,
                        143405114.68845367,
                        1632716630.39767,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        626974274.45348454,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
    ),
)
def test_calc_tf_coil_costs(calctfcoilcostsparam, monkeypatch, costs2015):
    """
    Automatically generated Regression Unit Test for calc_tf_coil_costs.

    This test was generated using data from tests/regression/scenarios/costs_paper/IN.DAT.

    :param calctfcoilcostsparam: the data used to mock and assert in this test.
    :type calctfcoilcostsparam: calctfcoilcostsparam

    :param monkeypatch: pytest fixture used to mock module/class variables
    :type monkeypatch: _pytest.monkeypatch.monkeypatch
    """

    monkeypatch.setattr(tfcoil_variables, "n_tf_coils", calctfcoilcostsparam.n_tf_coils)

    monkeypatch.setattr(
        tfcoil_variables, "len_tf_coil", calctfcoilcostsparam.len_tf_coil
    )

    monkeypatch.setattr(
        tfcoil_variables, "n_tf_coil_turns", calctfcoilcostsparam.n_tf_coil_turns
    )

    monkeypatch.setattr(
        tfcoil_variables, "m_tf_coil_copper", calctfcoilcostsparam.m_tf_coil_copper
    )

    monkeypatch.setattr(
        tfcoil_variables,
        "m_tf_coil_superconductor",
        calctfcoilcostsparam.m_tf_coil_superconductor,
    )

    monkeypatch.setattr(
        cost_variables,
        "cost_factor_tf_coils",
        calctfcoilcostsparam.cost_factor_tf_coils,
    )

    monkeypatch.setattr(cost_variables, "costexp", calctfcoilcostsparam.costexp)

    monkeypatch.setattr(cost_2015_variables, "s_kref", calctfcoilcostsparam.s_kref)

    monkeypatch.setattr(cost_2015_variables, "s_k", calctfcoilcostsparam.s_k)

    monkeypatch.setattr(cost_2015_variables, "s_cref", calctfcoilcostsparam.s_cref)

    monkeypatch.setattr(cost_2015_variables, "s_cost", calctfcoilcostsparam.s_cost)

    monkeypatch.setattr(
        cost_2015_variables, "s_cost_factor", calctfcoilcostsparam.s_cost_factor
    )

    costs2015.calc_tf_coil_costs()

    assert cost_2015_variables.s_kref == pytest.approx(
        calctfcoilcostsparam.expected_s_kref
    )

    assert cost_2015_variables.s_k == pytest.approx(calctfcoilcostsparam.expected_s_k)

    assert cost_2015_variables.s_cref == pytest.approx(
        calctfcoilcostsparam.expected_s_cref
    )

    assert cost_2015_variables.s_cost == pytest.approx(
        calctfcoilcostsparam.expected_s_cost
    )

    assert cost_2015_variables.s_cost_factor == pytest.approx(
        calctfcoilcostsparam.expected_s_cost_factor
    )


class CalcRemoteHandlingCostsParam(NamedTuple):
    armour_fw_bl_mass: Any = None

    cost_factor_rh: Any = None

    costexp: Any = None

    num_rh_systems: Any = None

    s_kref: Any = None

    s_k: Any = None

    s_cref: Any = None

    s_cost: Any = None

    s_cost_factor: Any = None

    expected_s_kref: Any = None

    expected_s_k: Any = None

    expected_s_cref: Any = None

    expected_s_cost: Any = None

    expected_s_cost_factor: Any = None


@pytest.mark.parametrize(
    "calcremotehandlingcostsparam",
    (
        CalcRemoteHandlingCostsParam(
            armour_fw_bl_mass=3075642.4259914826,
            cost_factor_rh=1,
            costexp=0.80000000000000004,
            num_rh_systems=4,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
        CalcRemoteHandlingCostsParam(
            armour_fw_bl_mass=2995895.8885181043,
            cost_factor_rh=1,
            costexp=0.80000000000000004,
            num_rh_systems=4,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        31962.659424309255,
                        109.38112972595434,
                        823.30859959198483,
                        317.36083856661548,
                        13.008675,
                        129.99240835373195,
                        2752.0808825830936,
                        0,
                        1053.7701699348972,
                        1053.7701699348972,
                        16.287956497695848,
                        0,
                        839.28690525651302,
                        0,
                        167969.39357288877,
                        448111.42734382977,
                        143012.18071796698,
                        0,
                        167969.39357288877,
                        0,
                        3104788.5485843536,
                        1009792.4984409281,
                        911936.28164034768,
                        99793.201153656977,
                        4758638.891603685,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        893.59786239725906,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2410693739.0726619,
                        6891011.1727351239,
                        473739866.32260108,
                        105883266.24913743,
                        42456884.340659343,
                        29961664.852262605,
                        43063811.083146818,
                        3147520243.093204,
                        63837385.248702273,
                        319708329.08223164,
                        169309805.61532342,
                        552855519.94625735,
                        331380200.55787051,
                        0,
                        732959475.07431877,
                        34152008.422703326,
                        386819831.65432388,
                        4000000,
                        143405114.68845367,
                        1632716630.39767,
                        555779082.90550709,
                        65381162.871723056,
                        1695083945.1969879,
                        67189649.2001881,
                        359227796.70929718,
                        2742661636.8837032,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        626974274.45348454,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31962.659424309255,
                        109.38112972595434,
                        823.30859959198483,
                        317.36083856661548,
                        13.008675,
                        129.99240835373195,
                        2752.0808825830936,
                        0,
                        1053.7701699348972,
                        1053.7701699348972,
                        16.287956497695848,
                        0,
                        839.28690525651302,
                        0,
                        167969.39357288877,
                        448111.42734382977,
                        143012.18071796698,
                        0,
                        167969.39357288877,
                        0,
                        3104788.5485843536,
                        1009792.4984409281,
                        911936.28164034768,
                        99793.201153656977,
                        4758638.891603685,
                        0,
                        2995895.8885181043,
                        2995895.8885181043,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        893.59786239725906,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2410693739.0726619,
                        6891011.1727351239,
                        473739866.32260108,
                        105883266.24913743,
                        42456884.340659343,
                        29961664.852262605,
                        43063811.083146818,
                        3147520243.093204,
                        63837385.248702273,
                        319708329.08223164,
                        169309805.61532342,
                        552855519.94625735,
                        331380200.55787051,
                        0,
                        732959475.07431877,
                        34152008.422703326,
                        386819831.65432388,
                        4000000,
                        143405114.68845367,
                        1632716630.39767,
                        555779082.90550709,
                        65381162.871723056,
                        1695083945.1969879,
                        67189649.2001881,
                        359227796.70929718,
                        2742661636.8837032,
                        716815015.95863223,
                        2183095007.1949234,
                        0,
                        2899910023.1535559,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        626974274.45348454,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
    ),
)
def test_calc_remote_handling_costs(
    calcremotehandlingcostsparam, monkeypatch, costs2015
):
    """
    Automatically generated Regression Unit Test for calc_remote_handling_costs.

    This test was generated using data from tests/regression/scenarios/costs_paper/IN.DAT.

    :param calcremotehandlingcostsparam: the data used to mock and assert in this test.
    :type calcremotehandlingcostsparam: calcremotehandlingcostsparam

    :param monkeypatch: pytest fixture used to mock module/class variables
    :type monkeypatch: _pytest.monkeypatch.monkeypatch
    """

    monkeypatch.setattr(
        fwbs_variables,
        "armour_fw_bl_mass",
        calcremotehandlingcostsparam.armour_fw_bl_mass,
    )

    monkeypatch.setattr(
        cost_variables, "cost_factor_rh", calcremotehandlingcostsparam.cost_factor_rh
    )

    monkeypatch.setattr(cost_variables, "costexp", calcremotehandlingcostsparam.costexp)

    monkeypatch.setattr(
        cost_variables, "num_rh_systems", calcremotehandlingcostsparam.num_rh_systems
    )

    monkeypatch.setattr(
        cost_2015_variables, "s_kref", calcremotehandlingcostsparam.s_kref
    )

    monkeypatch.setattr(cost_2015_variables, "s_k", calcremotehandlingcostsparam.s_k)

    monkeypatch.setattr(
        cost_2015_variables, "s_cref", calcremotehandlingcostsparam.s_cref
    )

    monkeypatch.setattr(
        cost_2015_variables, "s_cost", calcremotehandlingcostsparam.s_cost
    )

    monkeypatch.setattr(
        cost_2015_variables, "s_cost_factor", calcremotehandlingcostsparam.s_cost_factor
    )

    costs2015.calc_remote_handling_costs()

    assert cost_2015_variables.s_kref == pytest.approx(
        calcremotehandlingcostsparam.expected_s_kref
    )

    assert cost_2015_variables.s_k == pytest.approx(
        calcremotehandlingcostsparam.expected_s_k
    )

    assert cost_2015_variables.s_cref == pytest.approx(
        calcremotehandlingcostsparam.expected_s_cref
    )

    assert cost_2015_variables.s_cost == pytest.approx(
        calcremotehandlingcostsparam.expected_s_cost
    )

    assert cost_2015_variables.s_cost_factor == pytest.approx(
        calcremotehandlingcostsparam.expected_s_cost_factor
    )


class CalcNPlantAndVvCostsParam(NamedTuple):
    rsldo: Any = None

    dr_vv_outboard: Any = None

    helpow: Any = None

    cost_factor_vv: Any = None

    costexp: Any = None

    s_kref: Any = None

    s_k: Any = None

    s_cref: Any = None

    s_cost: Any = None

    s_cost_factor: Any = None

    expected_s_kref: Any = None

    expected_s_k: Any = None

    expected_s_cref: Any = None

    expected_s_cost: Any = None

    expected_s_cost_factor: Any = None


@pytest.mark.parametrize(
    "calcnplantandvvcostsparam",
    (
        CalcNPlantAndVvCostsParam(
            rsldo=13.471451612903225,
            dr_vv_outboard=0.32000000000000006,
            helpow=142703.41458500578,
            cost_factor_vv=1,
            costexp=0.80000000000000004,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
        CalcNPlantAndVvCostsParam(
            rsldo=13.459451612903226,
            dr_vv_outboard=0.32000000000000006,
            helpow=823308.59959198488,
            cost_factor_vv=1,
            costexp=0.80000000000000004,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        31962.659424309255,
                        109.38112972595434,
                        823.30859959198483,
                        317.36083856661548,
                        13.008675,
                        129.99240835373195,
                        2752.0808825830936,
                        0,
                        1053.7701699348972,
                        1053.7701699348972,
                        16.287956497695848,
                        0,
                        839.28690525651302,
                        0,
                        167969.39357288877,
                        448111.42734382977,
                        143012.18071796698,
                        0,
                        167969.39357288877,
                        0,
                        3104788.5485843536,
                        1009792.4984409281,
                        911936.28164034768,
                        99793.201153656977,
                        4758638.891603685,
                        0,
                        2995895.8885181043,
                        2995895.8885181043,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        893.59786239725906,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2410693739.0726619,
                        6891011.1727351239,
                        473739866.32260108,
                        105883266.24913743,
                        42456884.340659343,
                        29961664.852262605,
                        43063811.083146818,
                        3147520243.093204,
                        63837385.248702273,
                        319708329.08223164,
                        169309805.61532342,
                        552855519.94625735,
                        331380200.55787051,
                        0,
                        732959475.07431877,
                        34152008.422703326,
                        386819831.65432388,
                        4000000,
                        143405114.68845367,
                        1632716630.39767,
                        555779082.90550709,
                        65381162.871723056,
                        1695083945.1969879,
                        67189649.2001881,
                        359227796.70929718,
                        2742661636.8837032,
                        716815015.95863223,
                        2183095007.1949234,
                        0,
                        2899910023.1535559,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        626974274.45348454,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31962.659424309255,
                        109.38112972595434,
                        823.30859959198483,
                        317.36083856661548,
                        13.008675,
                        129.99240835373195,
                        2752.0808825830936,
                        0,
                        1053.7701699348972,
                        1053.7701699348972,
                        16.287956497695848,
                        0,
                        839.28690525651302,
                        0,
                        167969.39357288877,
                        448111.42734382977,
                        143012.18071796698,
                        0,
                        167969.39357288877,
                        0,
                        3104788.5485843536,
                        1009792.4984409281,
                        911936.28164034768,
                        99793.201153656977,
                        4758638.891603685,
                        0,
                        2995895.8885181043,
                        2995895.8885181043,
                        0,
                        0,
                        189.87328675234133,
                        823308.59959198488,
                        0,
                        893.59786239725906,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2410693739.0726619,
                        6891011.1727351239,
                        473739866.32260108,
                        105883266.24913743,
                        42456884.340659343,
                        29961664.852262605,
                        43063811.083146818,
                        3147520243.093204,
                        63837385.248702273,
                        319708329.08223164,
                        169309805.61532342,
                        552855519.94625735,
                        331380200.55787051,
                        0,
                        732959475.07431877,
                        34152008.422703326,
                        386819831.65432388,
                        4000000,
                        143405114.68845367,
                        1632716630.39767,
                        555779082.90550709,
                        65381162.871723056,
                        1695083945.1969879,
                        67189649.2001881,
                        359227796.70929718,
                        2742661636.8837032,
                        716815015.95863223,
                        2183095007.1949234,
                        0,
                        2899910023.1535559,
                        941695739.24540162,
                        808672303.65268147,
                        1750368042.8980832,
                        626974274.45348454,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
    ),
)
def test_calc_n_plant_and_vv_costs(calcnplantandvvcostsparam, monkeypatch, costs2015):
    """
    Automatically generated Regression Unit Test for calc_n_plant_and_vv_costs.

    This test was generated using data from tests/regression/scenarios/costs_paper/IN.DAT.

    :param calcnplantandvvcostsparam: the data used to mock and assert in this test.
    :type calcnplantandvvcostsparam: calcnplantandvvcostsparam

    :param monkeypatch: pytest fixture used to mock module/class variables
    :type monkeypatch: _pytest.monkeypatch.monkeypatch
    """

    monkeypatch.setattr(build_variables, "rsldo", calcnplantandvvcostsparam.rsldo)

    monkeypatch.setattr(
        build_variables, "dr_vv_outboard", calcnplantandvvcostsparam.dr_vv_outboard
    )

    monkeypatch.setattr(
        heat_transport_variables, "helpow", calcnplantandvvcostsparam.helpow
    )

    monkeypatch.setattr(
        cost_variables, "cost_factor_vv", calcnplantandvvcostsparam.cost_factor_vv
    )

    monkeypatch.setattr(cost_variables, "costexp", calcnplantandvvcostsparam.costexp)

    monkeypatch.setattr(cost_2015_variables, "s_kref", calcnplantandvvcostsparam.s_kref)

    monkeypatch.setattr(cost_2015_variables, "s_k", calcnplantandvvcostsparam.s_k)

    monkeypatch.setattr(cost_2015_variables, "s_cref", calcnplantandvvcostsparam.s_cref)

    monkeypatch.setattr(cost_2015_variables, "s_cost", calcnplantandvvcostsparam.s_cost)

    monkeypatch.setattr(
        cost_2015_variables, "s_cost_factor", calcnplantandvvcostsparam.s_cost_factor
    )

    costs2015.calc_n_plant_and_vv_costs()

    assert cost_2015_variables.s_kref == pytest.approx(
        calcnplantandvvcostsparam.expected_s_kref
    )

    assert cost_2015_variables.s_k == pytest.approx(
        calcnplantandvvcostsparam.expected_s_k
    )

    assert cost_2015_variables.s_cref == pytest.approx(
        calcnplantandvvcostsparam.expected_s_cref
    )

    assert cost_2015_variables.s_cost == pytest.approx(
        calcnplantandvvcostsparam.expected_s_cost
    )

    assert cost_2015_variables.s_cost_factor == pytest.approx(
        calcnplantandvvcostsparam.expected_s_cost_factor
    )


class CalcEnergyConversionSystemParam(NamedTuple):
    p_plant_electric_gross_mw: Any = None

    cost_factor_bop: Any = None

    costexp: Any = None

    s_kref: Any = None

    s_k: Any = None

    s_cref: Any = None

    s_cost: Any = None

    s_cost_factor: Any = None

    expected_s_kref: Any = None

    expected_s_k: Any = None

    expected_s_cref: Any = None

    expected_s_cost: Any = None

    expected_s_cost_factor: Any = None


@pytest.mark.parametrize(
    "calcenergyconversionsystemparam",
    (
        CalcEnergyConversionSystemParam(
            p_plant_electric_gross_mw=893.59786239725906,
            cost_factor_bop=1,
            costexp=0.80000000000000004,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        893.59786239725906,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        626974274.45348454,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
        CalcEnergyConversionSystemParam(
            p_plant_electric_gross_mw=792.46889728924157,
            cost_factor_bop=1,
            costexp=0.80000000000000004,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        31962.659424309255,
                        109.38112972595434,
                        823.30859959198483,
                        317.36083856661548,
                        13.008675,
                        129.99240835373195,
                        2752.0808825830936,
                        0,
                        1053.7701699348972,
                        1053.7701699348972,
                        16.287956497695848,
                        0,
                        839.28690525651302,
                        0,
                        167969.39357288877,
                        448111.42734382977,
                        143012.18071796698,
                        0,
                        167969.39357288877,
                        0,
                        3104788.5485843536,
                        1009792.4984409281,
                        911936.28164034768,
                        99793.201153656977,
                        4758638.891603685,
                        0,
                        2995895.8885181043,
                        2995895.8885181043,
                        0,
                        0,
                        189.87328675234133,
                        823308.59959198488,
                        0,
                        893.59786239725906,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2410693739.0726619,
                        6891011.1727351239,
                        473739866.32260108,
                        105883266.24913743,
                        42456884.340659343,
                        29961664.852262605,
                        43063811.083146818,
                        3147520243.093204,
                        63837385.248702273,
                        319708329.08223164,
                        169309805.61532342,
                        552855519.94625735,
                        331380200.55787051,
                        0,
                        732959475.07431877,
                        34152008.422703326,
                        386819831.65432388,
                        4000000,
                        143405114.68845367,
                        1632716630.39767,
                        555779082.90550709,
                        65381162.871723056,
                        1695083945.1969879,
                        67189649.2001881,
                        359227796.70929718,
                        2742661636.8837032,
                        716815015.95863223,
                        2183095007.1949234,
                        0,
                        2899910023.1535559,
                        941695739.24540162,
                        808672303.65268147,
                        1750368042.8980832,
                        626974274.45348454,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31962.659424309255,
                        109.38112972595434,
                        823.30859959198483,
                        317.36083856661548,
                        13.008675,
                        129.99240835373195,
                        2752.0808825830936,
                        0,
                        1053.7701699348972,
                        1053.7701699348972,
                        16.287956497695848,
                        0,
                        839.28690525651302,
                        0,
                        167969.39357288877,
                        448111.42734382977,
                        143012.18071796698,
                        0,
                        167969.39357288877,
                        0,
                        3104788.5485843536,
                        1009792.4984409281,
                        911936.28164034768,
                        99793.201153656977,
                        4758638.891603685,
                        0,
                        2995895.8885181043,
                        2995895.8885181043,
                        0,
                        0,
                        189.87328675234133,
                        823308.59959198488,
                        0,
                        792.46889728924157,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2410693739.0726619,
                        6891011.1727351239,
                        473739866.32260108,
                        105883266.24913743,
                        42456884.340659343,
                        29961664.852262605,
                        43063811.083146818,
                        3147520243.093204,
                        63837385.248702273,
                        319708329.08223164,
                        169309805.61532342,
                        552855519.94625735,
                        331380200.55787051,
                        0,
                        732959475.07431877,
                        34152008.422703326,
                        386819831.65432388,
                        4000000,
                        143405114.68845367,
                        1632716630.39767,
                        555779082.90550709,
                        65381162.871723056,
                        1695083945.1969879,
                        67189649.2001881,
                        359227796.70929718,
                        2742661636.8837032,
                        716815015.95863223,
                        2183095007.1949234,
                        0,
                        2899910023.1535559,
                        941695739.24540162,
                        808672303.65268147,
                        1750368042.8980832,
                        569536819.2223196,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
    ),
)
def test_calc_energy_conversion_system(
    calcenergyconversionsystemparam, monkeypatch, costs2015
):
    """
    Automatically generated Regression Unit Test for calc_energy_conversion_system.

    This test was generated using data from tests/regression/scenarios/costs_paper/IN.DAT.

    :param calcenergyconversionsystemparam: the data used to mock and assert in this test.
    :type calcenergyconversionsystemparam: calcenergyconversionsystemparam

    :param monkeypatch: pytest fixture used to mock module/class variables
    :type monkeypatch: _pytest.monkeypatch.monkeypatch
    """

    monkeypatch.setattr(
        heat_transport_variables,
        "p_plant_electric_gross_mw",
        calcenergyconversionsystemparam.p_plant_electric_gross_mw,
    )

    monkeypatch.setattr(
        cost_variables,
        "cost_factor_bop",
        calcenergyconversionsystemparam.cost_factor_bop,
    )

    monkeypatch.setattr(
        cost_variables, "costexp", calcenergyconversionsystemparam.costexp
    )

    monkeypatch.setattr(
        cost_2015_variables, "s_kref", calcenergyconversionsystemparam.s_kref
    )

    monkeypatch.setattr(cost_2015_variables, "s_k", calcenergyconversionsystemparam.s_k)

    monkeypatch.setattr(
        cost_2015_variables, "s_cref", calcenergyconversionsystemparam.s_cref
    )

    monkeypatch.setattr(
        cost_2015_variables, "s_cost", calcenergyconversionsystemparam.s_cost
    )

    monkeypatch.setattr(
        cost_2015_variables,
        "s_cost_factor",
        calcenergyconversionsystemparam.s_cost_factor,
    )

    costs2015.calc_energy_conversion_system()

    assert cost_2015_variables.s_kref == pytest.approx(
        calcenergyconversionsystemparam.expected_s_kref
    )

    assert cost_2015_variables.s_k == pytest.approx(
        calcenergyconversionsystemparam.expected_s_k
    )

    assert cost_2015_variables.s_cref == pytest.approx(
        calcenergyconversionsystemparam.expected_s_cref
    )

    assert cost_2015_variables.s_cost == pytest.approx(
        calcenergyconversionsystemparam.expected_s_cost
    )

    assert cost_2015_variables.s_cost_factor == pytest.approx(
        calcenergyconversionsystemparam.expected_s_cost_factor
    )


class CalcRemainingSubsystemsParam(NamedTuple):
    p_hcd_injected_total_mw: Any = None

    p_plasma_separatrix_mw: Any = None

    p_fusion_total_mw: Any = None

    t_plasma_res_diffusion: Any = None

    itr_sum: Any = None

    ensxpfm: Any = None

    p_plant_primary_heat_mw: Any = None

    p_plant_secondary_heat_mw: Any = None

    helpow: Any = None

    m_vv: Any = None

    r_cryostat_inboard: Any = None

    z_cryostat_half_inside: Any = None

    cost_factor_misc: Any = None

    costexp: Any = None

    s_kref: Any = None

    s_k: Any = None

    s_cref: Any = None

    s_cost: Any = None

    s_cost_factor: Any = None

    expected_s_kref: Any = None

    expected_s_k: Any = None

    expected_s_cref: Any = None

    expected_s_cost: Any = None

    expected_s_cost_factor: Any = None


@pytest.mark.parametrize(
    "calcremainingsubsystemsparam",
    (
        CalcRemainingSubsystemsParam(
            p_hcd_injected_total_mw=43.745615131519273,
            p_plasma_separatrix_mw=94.203763268233445,
            p_fusion_total_mw=1726.9363495105574,
            t_plasma_res_diffusion=2562.1529343276788,
            itr_sum=687546826.85995734,
            ensxpfm=34911.529178721656,
            p_plant_primary_heat_mw=2112.8165753998965,
            p_plant_secondary_heat_mw=311.54038043019023,
            helpow=142703.41458500578,
            m_vv=8957118.946216708,
            r_cryostat_inboard=18.314040399601147,
            z_cryostat_half_inside=15.118436894660423,
            cost_factor_misc=1,
            costexp=0.80000000000000004,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        893.59786239725906,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        626974274.45348454,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31860.684029365962,
                        109.38112972595434,
                        142.70341458500579,
                        317.34003535862178,
                        13.008675,
                        130.10721529398921,
                        2424.3569558300869,
                        0,
                        1053.7029803861078,
                        1053.7029803861078,
                        16.311956497695849,
                        0,
                        839.62890585955893,
                        0,
                        168037.83933742455,
                        571428.49843972409,
                        185123.56268983445,
                        0,
                        168037.83933742455,
                        0,
                        3109037.1348153283,
                        1011174.2964081274,
                        913184.17336278723,
                        99694.050584504424,
                        4763344.8004005533,
                        0,
                        3075642.4259914826,
                        3075642.4259914826,
                        0,
                        0,
                        190.20413759105097,
                        142703.41458500578,
                        0,
                        893.59786239725906,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2403002531.5649948,
                        6891011.1727351239,
                        82112948.3923558,
                        105876325.5326307,
                        42456884.340659343,
                        29988126.45190727,
                        37935676.456568524,
                        2743093503.9118519,
                        63836367.442324109,
                        319692021.01357889,
                        169509356.09660494,
                        553037744.55250788,
                        331488223.31890893,
                        0,
                        733198403.97258568,
                        41483648.939582437,
                        475531913.31474745,
                        4000000,
                        143451861.64681023,
                        1729154051.1926348,
                        556387421.253178,
                        65434828.658710383,
                        1696475294.1717234,
                        67136238.314117998,
                        359511966.39346248,
                        2744945748.7911921,
                        732039296.96567428,
                        2229461295.7277575,
                        0,
                        2961500592.6934319,
                        943008221.18258262,
                        199007727.17609176,
                        1142015948.3586743,
                        626974274.45348454,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
        CalcRemainingSubsystemsParam(
            p_hcd_injected_total_mw=43.745615131519266,
            p_plasma_separatrix_mw=94.062415557688894,
            p_fusion_total_mw=1726.1944723154274,
            t_plasma_res_diffusion=2562.1529343276788,
            itr_sum=1176301401.3409874,
            ensxpfm=34908.848681194133,
            p_plant_primary_heat_mw=2111.8102173541502,
            p_plant_secondary_heat_mw=640.27066522894324,
            helpow=823308.59959198488,
            m_vv=8948002.9350915737,
            r_cryostat_inboard=18.31462428923539,
            z_cryostat_half_inside=15.165858901796364,
            cost_factor_misc=1,
            costexp=0.80000000000000004,
            s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_k=np.array(
                np.array(
                    (
                        0,
                        31962.659424309255,
                        109.38112972595434,
                        823.30859959198483,
                        317.36083856661548,
                        13.008675,
                        129.99240835373195,
                        2752.0808825830936,
                        0,
                        1053.7701699348972,
                        1053.7701699348972,
                        16.287956497695848,
                        0,
                        839.28690525651302,
                        0,
                        167969.39357288877,
                        448111.42734382977,
                        143012.18071796698,
                        0,
                        167969.39357288877,
                        0,
                        3104788.5485843536,
                        1009792.4984409281,
                        911936.28164034768,
                        99793.201153656977,
                        4758638.891603685,
                        0,
                        2995895.8885181043,
                        2995895.8885181043,
                        0,
                        0,
                        189.87328675234133,
                        823308.59959198488,
                        0,
                        792.46889728924157,
                        687546826.85995734,
                        8957118.946216708,
                        94.203763268233445,
                        0,
                        0,
                        43.745615131519273,
                        0,
                        2424.3569558300869,
                        31860.684029365962,
                        2424.3569558300869,
                        5586.7784350253387,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        1726.9363495105574,
                        142703.41458500578,
                        13625856.876448559,
                        43.745615131519273,
                        0,
                        1726.9363495105574,
                        1053.7029803861078,
                        8716253520.3402939,
                        8716253520.3402939,
                        0,
                        31860.684029365962,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2410693739.0726619,
                        6891011.1727351239,
                        473739866.32260108,
                        105883266.24913743,
                        42456884.340659343,
                        29961664.852262605,
                        43063811.083146818,
                        3147520243.093204,
                        63837385.248702273,
                        319708329.08223164,
                        169309805.61532342,
                        552855519.94625735,
                        331380200.55787051,
                        0,
                        732959475.07431877,
                        34152008.422703326,
                        386819831.65432388,
                        4000000,
                        143405114.68845367,
                        1632716630.39767,
                        555779082.90550709,
                        65381162.871723056,
                        1695083945.1969879,
                        67189649.2001881,
                        359227796.70929718,
                        2742661636.8837032,
                        716815015.95863223,
                        2183095007.1949234,
                        0,
                        2899910023.1535559,
                        941695739.24540162,
                        808672303.65268147,
                        1750368042.8980832,
                        569536819.2223196,
                        1450149527.2235641,
                        324203290.32744282,
                        277509048.94950575,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        131053037.51814137,
                        537573569.2491281,
                        2372059979.0783587,
                        167907421.18808705,
                        67388388.337830186,
                        86257137.072422639,
                        541802642.23615468,
                        609191030.57398486,
                        918675205.68498182,
                        1750289267.8736322,
                        731469165.71004093,
                        640000000,
                        51215175.136750944,
                        62586386.529600464,
                        1907413326.4242437,
                        471184613.38642073,
                        1624000000,
                        197569773.3137821,
                        15000372954.995775,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_kref=np.array(
                np.array(
                    (
                        0,
                        18712,
                        120,
                        61,
                        153.76000000000002,
                        9.0999999999999996,
                        41,
                        880,
                        0,
                        638,
                        638,
                        14,
                        0,
                        613.80000000000007,
                        0,
                        82249,
                        244000,
                        210000,
                        0,
                        82249,
                        0,
                        64.700000000000003,
                        10,
                        100000,
                        29000,
                        4070000,
                        0,
                        4350000,
                        4350000,
                        0,
                        0,
                        94.090000000000003,
                        50000,
                        0,
                        692,
                        740000000,
                        5236000,
                        140,
                        0,
                        0,
                        50,
                        0,
                        550,
                        18700,
                        550,
                        3902,
                        500,
                        500,
                        500,
                        500,
                        50000,
                        8394543.5466946494,
                        50,
                        0,
                        500,
                        640,
                        3345000000,
                        3345000000,
                        0,
                        18700,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_k=np.array(
                np.array(
                    (
                        0,
                        31962.659424309255,
                        109.38112972595434,
                        823.30859959198483,
                        317.36083856661548,
                        13.008675,
                        129.99240835373195,
                        2752.0808825830936,
                        0,
                        1053.7701699348972,
                        1053.7701699348972,
                        16.287956497695848,
                        0,
                        839.28690525651302,
                        0,
                        167969.39357288877,
                        448111.42734382977,
                        143012.18071796698,
                        0,
                        167969.39357288877,
                        0,
                        3104788.5485843536,
                        1009792.4984409281,
                        911936.28164034768,
                        99793.201153656977,
                        4758638.891603685,
                        0,
                        2995895.8885181043,
                        2995895.8885181043,
                        0,
                        0,
                        189.87328675234133,
                        823308.59959198488,
                        0,
                        792.46889728924157,
                        1176301401.3409874,
                        8948002.9350915737,
                        94.062415557688894,
                        0,
                        0,
                        43.745615131519266,
                        0,
                        2752.0808825830936,
                        31962.659424309255,
                        2752.0808825830936,
                        5597.9378407451622,
                        1726.1944723154274,
                        1726.1944723154274,
                        1726.1944723154274,
                        1726.1944723154274,
                        823308.59959198488,
                        13624810.686936757,
                        43.745615131519266,
                        0,
                        1726.1944723154274,
                        1053.7701699348972,
                        9395293460.3587341,
                        9395293460.3587341,
                        0,
                        31962.659424309255,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cref=np.array(
                np.array(
                    (
                        34830000,
                        1411300000,
                        7560000,
                        35100000,
                        51300000,
                        29700000,
                        9450000,
                        13770000,
                        0,
                        318000,
                        214000000,
                        150000000,
                        0,
                        258000000,
                        0,
                        414000000,
                        21000000,
                        526000000,
                        4000000,
                        81000000,
                        0,
                        100000,
                        65000,
                        450000000,
                        25000000,
                        317000000,
                        0,
                        966000000,
                        2942000000,
                        0,
                        0,
                        537000000,
                        86000000,
                        0,
                        511000000,
                        1538000000,
                        211000000,
                        381000000,
                        0,
                        0,
                        90000000,
                        0,
                        40000000,
                        351000000,
                        724000000,
                        126000000,
                        25000000,
                        32000000,
                        201000000,
                        226000000,
                        397000000,
                        1188000000,
                        814000000,
                        640000000,
                        19000000,
                        42000000,
                        732000000,
                        219000000,
                        1624000000,
                        129000000,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost=np.array(
                np.array(
                    (
                        34830000,
                        2410693739.0726619,
                        6891011.1727351239,
                        473739866.32260108,
                        105883266.24913743,
                        42456884.340659343,
                        29961664.852262605,
                        43063811.083146818,
                        3147520243.093204,
                        63837385.248702273,
                        319708329.08223164,
                        169309805.61532342,
                        552855519.94625735,
                        331380200.55787051,
                        0,
                        732959475.07431877,
                        34152008.422703326,
                        386819831.65432388,
                        4000000,
                        143405114.68845367,
                        1632716630.39767,
                        555779082.90550709,
                        65381162.871723056,
                        1695083945.1969879,
                        67189649.2001881,
                        359227796.70929718,
                        2742661636.8837032,
                        716815015.95863223,
                        2183095007.1949234,
                        0,
                        2899910023.1535559,
                        941695739.24540162,
                        808672303.65268147,
                        1750368042.8980832,
                        569536819.2223196,
                        2228362550.6776891,
                        323939299.93245149,
                        277175888.94450796,
                        0,
                        0,
                        80874969.181699857,
                        0,
                        145043674.83249888,
                        538949603.82745028,
                        2625290514.4682298,
                        168175679.26663655,
                        67365227.759107724,
                        86227491.531657889,
                        541616431.18322611,
                        608981658.94233382,
                        3733057029.6524944,
                        1750181757.6685214,
                        731469165.71004093,
                        640000000,
                        51197573.096921869,
                        62589579.174462266,
                        2056010407.4686377,
                        500328793.59473228,
                        1624000000,
                        198075495.42376378,
                        19038912792.337063,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
            expected_s_cost_factor=np.array(
                np.array(
                    (
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        1,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                    ),
                    order="F",
                ),
                order="F",
            ).transpose(),
        ),
    ),
)
def test_calc_remaining_subsystems(calcremainingsubsystemsparam, monkeypatch, costs2015):
    """
    Automatically generated Regression Unit Test for calc_remaining_subsystems.

    This test was generated using data from tests/regression/scenarios/costs_paper/IN.DAT.

    :param calcremainingsubsystemsparam: the data used to mock and assert in this test.
    :type calcremainingsubsystemsparam: calcremainingsubsystemsparam

    :param monkeypatch: pytest fixture used to mock module/class variables
    :type monkeypatch: _pytest.monkeypatch.monkeypatch
    """

    monkeypatch.setattr(
        current_drive_variables,
        "p_hcd_injected_total_mw",
        calcremainingsubsystemsparam.p_hcd_injected_total_mw,
    )

    monkeypatch.setattr(
        physics_variables,
        "p_plasma_separatrix_mw",
        calcremainingsubsystemsparam.p_plasma_separatrix_mw,
    )

    monkeypatch.setattr(
        physics_variables,
        "p_fusion_total_mw",
        calcremainingsubsystemsparam.p_fusion_total_mw,
    )

    monkeypatch.setattr(
        physics_variables,
        "t_plasma_res_diffusion",
        calcremainingsubsystemsparam.t_plasma_res_diffusion,
    )

    monkeypatch.setattr(
        pfcoil_variables, "itr_sum", calcremainingsubsystemsparam.itr_sum
    )

    monkeypatch.setattr(
        pf_power_variables,
        "ensxpfm",
        calcremainingsubsystemsparam.ensxpfm,
    )

    monkeypatch.setattr(
        heat_transport_variables,
        "p_plant_primary_heat_mw",
        calcremainingsubsystemsparam.p_plant_primary_heat_mw,
    )

    monkeypatch.setattr(
        heat_transport_variables,
        "p_plant_secondary_heat_mw",
        calcremainingsubsystemsparam.p_plant_secondary_heat_mw,
    )

    monkeypatch.setattr(
        heat_transport_variables, "helpow", calcremainingsubsystemsparam.helpow
    )

    monkeypatch.setattr(fwbs_variables, "m_vv", calcremainingsubsystemsparam.m_vv)

    monkeypatch.setattr(
        fwbs_variables,
        "r_cryostat_inboard",
        calcremainingsubsystemsparam.r_cryostat_inboard,
    )

    monkeypatch.setattr(
        fwbs_variables,
        "z_cryostat_half_inside",
        calcremainingsubsystemsparam.z_cryostat_half_inside,
    )

    monkeypatch.setattr(
        cost_variables,
        "cost_factor_misc",
        calcremainingsubsystemsparam.cost_factor_misc,
    )

    monkeypatch.setattr(cost_variables, "costexp", calcremainingsubsystemsparam.costexp)

    monkeypatch.setattr(
        cost_2015_variables, "s_kref", calcremainingsubsystemsparam.s_kref
    )

    monkeypatch.setattr(cost_2015_variables, "s_k", calcremainingsubsystemsparam.s_k)

    monkeypatch.setattr(
        cost_2015_variables, "s_cref", calcremainingsubsystemsparam.s_cref
    )

    monkeypatch.setattr(
        cost_2015_variables, "s_cost", calcremainingsubsystemsparam.s_cost
    )

    monkeypatch.setattr(
        cost_2015_variables, "s_cost_factor", calcremainingsubsystemsparam.s_cost_factor
    )

    costs2015.calc_remaining_subsystems()

    assert cost_2015_variables.s_kref == pytest.approx(
        calcremainingsubsystemsparam.expected_s_kref
    )

    assert cost_2015_variables.s_k == pytest.approx(
        calcremainingsubsystemsparam.expected_s_k
    )

    assert cost_2015_variables.s_cref == pytest.approx(
        calcremainingsubsystemsparam.expected_s_cref
    )

    assert cost_2015_variables.s_cost == pytest.approx(
        calcremainingsubsystemsparam.expected_s_cost
    )

    assert cost_2015_variables.s_cost_factor == pytest.approx(
        calcremainingsubsystemsparam.expected_s_cost_factor
    )


class ValueFunctionParam(NamedTuple):
    x: Any = None

    expected_v: Any = None


@pytest.mark.parametrize(
    "valuefunctionparam",
    (
        ValueFunctionParam(
            x=0.83463014000000002,
            expected_v=1.083401311692469,
        ),
        ValueFunctionParam(
            x=0.055650000000000005,
            expected_v=2.5162783171369218,
        ),
    ),
)
def test_value_function(valuefunctionparam, monkeypatch, costs2015):
    """
    Automatically generated Regression Unit Test for value_function.

    This test was generated using data from tests/regression/scenarios/costs_paper/IN.DAT.

    :param valuefunctionparam: the data used to mock and assert in this test.
    :type valuefunctionparam: valuefunctionparam

    :param monkeypatch: pytest fixture used to mock module/class variables
    :type monkeypatch: _pytest.monkeypatch.monkeypatch
    """

    v = costs2015.value_function(x=valuefunctionparam.x)

    assert v == pytest.approx(valuefunctionparam.expected_v)
